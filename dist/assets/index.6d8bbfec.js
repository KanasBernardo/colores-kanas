const d=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}};d();(function(h){var t={init:function(){this.c=document.getElementById("game"),this.c.width=this.c.width,this.c.height=this.c.height,this.ctx=this.c.getContext("2d"),this.color="rgba(20,20,20,.7)",this.bullets=[],this.enemyBullets=[],this.enemies=[],this.particles=[],this.bulletIndex=0,this.enemyBulletIndex=0,this.enemyIndex=0,this.particleIndex=0,this.maxParticles=10,this.maxEnemies=6,this.enemiesAlive=0,this.currentFrame=0,this.maxLives=3,this.life=0,this.binding(),this.player=new r,this.score=0,this.paused=!1,this.shooting=!1,this.oneShot=!1,this.isGameOver=!1,this.requestAnimationFrame=h.requestAnimationFrame||h.webkitRequestAnimationFrame||h.mozRequestAnimationFrame;for(var e=0;e<this.maxEnemies;e++)new s,this.enemiesAlive++;this.invincibleMode(2e3),this.loop()},binding:function(){h.addEventListener("keydown",this.buttonDown),h.addEventListener("keyup",this.buttonUp),h.addEventListener("keypress",this.keyPressed),this.c.addEventListener("click",this.clicked)},clicked:function(){t.paused?t.isGameOver?t.init():(t.unPause(),t.loop(),t.invincibleMode(1e3)):t.pause()},keyPressed:function(e){e.keyCode===32&&(!t.player.invincible&&!t.oneShot&&(t.player.shoot(),t.oneShot=!0),t.isGameOver&&t.init(),e.preventDefault())},buttonUp:function(e){e.keyCode===32&&(t.shooting=!1,t.oneShot=!1,e.preventDefault()),(e.keyCode===37||e.keyCode===65)&&(t.player.movingLeft=!1),(e.keyCode===39||e.keyCode===68)&&(t.player.movingRight=!1)},buttonDown:function(e){e.keyCode===32&&(t.shooting=!0),(e.keyCode===37||e.keyCode===65)&&(t.player.movingLeft=!0),(e.keyCode===39||e.keyCode===68)&&(t.player.movingRight=!0)},random:function(e,i){return Math.floor(Math.random()*(i-e)+e)},invincibleMode:function(e){this.player.invincible=!0,setTimeout(function(){t.player.invincible=!1},e)},collision:function(e,i){return!(e.y+e.height<i.y||e.y>i.y+i.height||e.x+e.width<i.x||e.x>i.x+i.width)},clear:function(){this.ctx.fillStyle=t.color,this.ctx.fillRect(0,0,this.c.width,this.c.height)},pause:function(){this.paused=!0},unPause:function(){this.paused=!1},gameOver:function(){this.isGameOver=!0,this.clear();var e="Game Over",i="Puntuaci\xF3n: "+t.score,n="Pulsa espacio para volver a jugar";this.pause(),this.ctx.fillStyle="white",this.ctx.font="bold 30px Lato, sans-serif",this.ctx.fillText(e,this.c.width/2-this.ctx.measureText(e).width/2,this.c.height/2-50),this.ctx.fillText(i,this.c.width/2-this.ctx.measureText(i).width/2,this.c.height/2-5),this.ctx.font="bold 16px Lato, sans-serif",this.ctx.fillText(n,this.c.width/2-this.ctx.measureText(n).width/2,this.c.height/2+30)},updateScore:function(){this.ctx.fillStyle="white",this.ctx.font="16px Lato, sans-serif",this.ctx.fillText("Puntaje: "+this.score,8,20),this.ctx.fillText("Vidas: "+(this.maxLives-this.life),8,40)},loop:function(){if(!t.paused){t.clear();for(var e in t.enemies){var i=t.enemies[e];i.draw(),i.update(),t.currentFrame%i.shootingSpeed===0&&i.shoot()}for(var n in t.enemyBullets)t.enemyBullets[n].draw(),t.enemyBullets[n].update();for(var c in t.bullets)t.bullets[c].draw(),t.bullets[c].update();t.player.invincible?t.currentFrame%20===0&&t.player.draw():t.player.draw();for(var e in t.particles)t.particles[e].draw();t.player.update(),t.updateScore(),t.currentFrame=t.requestAnimationFrame.call(h,t.loop)}}},r=function(){this.width=60,this.height=20,this.x=t.c.width/2-this.width/2,this.y=t.c.height-this.height,this.movingLeft=!1,this.movingRight=!1,this.speed=8,this.invincible=!1,this.color="white"};r.prototype.die=function(){t.life<t.maxLives?(t.invincibleMode(2e3),t.life++):(t.pause(),t.gameOver())},r.prototype.draw=function(){t.ctx.fillStyle=this.color,t.ctx.fillRect(this.x,this.y,this.width,this.height)},r.prototype.update=function(){this.movingLeft&&this.x>0&&(this.x-=this.speed),this.movingRight&&this.x+this.width<t.c.width&&(this.x+=this.speed),t.shooting&&t.currentFrame%10===0&&this.shoot();for(var e in t.enemyBullets){var i=t.enemyBullets[e];t.collision(i,this)&&!t.player.invincible&&(this.die(),delete t.enemyBullets[e])}},r.prototype.shoot=function(){t.bullets[t.bulletIndex]=new l(this.x+this.width/2),t.bulletIndex++};var l=function(e){this.width=8,this.height=20,this.x=e,this.y=t.c.height-10,this.vy=8,this.index=t.bulletIndex,this.active=!0,this.color="white"};l.prototype.draw=function(){t.ctx.fillStyle=this.color,t.ctx.fillRect(this.x,this.y,this.width,this.height)},l.prototype.update=function(){this.y-=this.vy,this.y<0&&delete t.bullets[this.index]};var s=function(){this.width=60,this.height=20,this.x=t.random(0,t.c.width-this.width),this.y=t.random(10,40),this.vy=t.random(1,3)*.1,this.index=t.enemyIndex,t.enemies[t.enemyIndex]=this,t.enemyIndex++,this.speed=t.random(2,3),this.shootingSpeed=t.random(30,80),this.movingLeft=Math.random()<.5,this.color="hsl("+t.random(0,360)+", 60%, 50%)"};s.prototype.draw=function(){t.ctx.fillStyle=this.color,t.ctx.fillRect(this.x,this.y,this.width,this.height)},s.prototype.update=function(){this.movingLeft?this.x>0?(this.x-=this.speed,this.y+=this.vy):this.movingLeft=!1:this.x+this.width<t.c.width?(this.x+=this.speed,this.y+=this.vy):this.movingLeft=!0;for(var e in t.bullets){var i=t.bullets[e];t.collision(i,this)&&(this.die(),delete t.bullets[e])}},s.prototype.die=function(){this.explode(),delete t.enemies[this.index],t.score+=15,t.enemiesAlive=t.enemiesAlive>1?t.enemiesAlive-1:0,t.enemiesAlive<t.maxEnemies&&(t.enemiesAlive++,setTimeout(function(){new s},2e3))},s.prototype.explode=function(){for(var e=0;e<t.maxParticles;e++)new a(this.x+this.width/2,this.y,this.color)},s.prototype.shoot=function(){new o(this.x+this.width/2,this.y,this.color)};var o=function(e,i,n){this.width=8,this.height=20,this.x=e,this.y=i,this.vy=6,this.color=n,this.index=t.enemyBulletIndex,t.enemyBullets[t.enemyBulletIndex]=this,t.enemyBulletIndex++};o.prototype.draw=function(){t.ctx.fillStyle=this.color,t.ctx.fillRect(this.x,this.y,this.width,this.height)},o.prototype.update=function(){this.y+=this.vy,this.y>t.c.height&&delete t.enemyBullets[this.index]};var a=function(e,i,n){this.x=e,this.y=i,this.vx=t.random(-5,5),this.vy=t.random(-5,5),this.color=n||"orange",t.particles[t.particleIndex]=this,this.id=t.particleIndex,t.particleIndex++,this.life=0,this.gravity=.05,this.size=40,this.maxlife=100};a.prototype.draw=function(){this.x+=this.vx,this.y+=this.vy,this.vy+=this.gravity,this.size*=.89,t.ctx.fillStyle=this.color,t.ctx.fillRect(this.x,this.y,this.size,this.size),this.life++,this.life>=this.maxlife&&delete t.particles[this.id]},t.init()})(window);
